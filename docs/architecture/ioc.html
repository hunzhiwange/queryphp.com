<!DOCTYPE html>
<html lang="en-Us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>IOC 容器 | QueryPHP</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/logo.png">
    <link rel="manifest" href="/manifest.json">
    <meta name="description" content="High Performance PHP Progressive Framework.">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="preload" href="/assets/css/0.styles.f6f54dc7.css" as="style"><link rel="preload" href="/assets/js/app.1fa40908.js" as="script"><link rel="preload" href="/assets/js/3.7fead861.js" as="script"><link rel="preload" href="/assets/js/17.8b77d7e7.js" as="script"><link rel="prefetch" href="/assets/js/10.eac0eac5.js"><link rel="prefetch" href="/assets/js/100.368fa632.js"><link rel="prefetch" href="/assets/js/101.0345eff8.js"><link rel="prefetch" href="/assets/js/102.d5c1abfd.js"><link rel="prefetch" href="/assets/js/103.c2ed27ae.js"><link rel="prefetch" href="/assets/js/104.235016c1.js"><link rel="prefetch" href="/assets/js/105.18ef31e2.js"><link rel="prefetch" href="/assets/js/106.602be689.js"><link rel="prefetch" href="/assets/js/107.c1ba8d04.js"><link rel="prefetch" href="/assets/js/108.ae01d60e.js"><link rel="prefetch" href="/assets/js/109.bbfa3100.js"><link rel="prefetch" href="/assets/js/11.096072d6.js"><link rel="prefetch" href="/assets/js/110.f07513fa.js"><link rel="prefetch" href="/assets/js/111.2070321d.js"><link rel="prefetch" href="/assets/js/112.8dde6540.js"><link rel="prefetch" href="/assets/js/113.1ae49b3f.js"><link rel="prefetch" href="/assets/js/114.c5eac3ff.js"><link rel="prefetch" href="/assets/js/115.3ce51359.js"><link rel="prefetch" href="/assets/js/116.3014ec51.js"><link rel="prefetch" href="/assets/js/117.6b68b8e0.js"><link rel="prefetch" href="/assets/js/118.62a8b4e1.js"><link rel="prefetch" href="/assets/js/119.6ba9ec81.js"><link rel="prefetch" href="/assets/js/12.84f0634e.js"><link rel="prefetch" href="/assets/js/120.a3b52e87.js"><link rel="prefetch" href="/assets/js/121.a762d321.js"><link rel="prefetch" href="/assets/js/122.351ef06d.js"><link rel="prefetch" href="/assets/js/123.4b17841c.js"><link rel="prefetch" href="/assets/js/124.d1140204.js"><link rel="prefetch" href="/assets/js/125.6b0ebc24.js"><link rel="prefetch" href="/assets/js/126.a6497209.js"><link rel="prefetch" href="/assets/js/127.3ec06ddb.js"><link rel="prefetch" href="/assets/js/128.e24bbfd7.js"><link rel="prefetch" href="/assets/js/129.02081699.js"><link rel="prefetch" href="/assets/js/13.b6d97674.js"><link rel="prefetch" href="/assets/js/130.0f980467.js"><link rel="prefetch" href="/assets/js/131.6a2bb817.js"><link rel="prefetch" href="/assets/js/132.2e2986f5.js"><link rel="prefetch" href="/assets/js/133.51a1a1d4.js"><link rel="prefetch" href="/assets/js/134.db932fe4.js"><link rel="prefetch" href="/assets/js/135.105dd23f.js"><link rel="prefetch" href="/assets/js/136.6bf7f9e2.js"><link rel="prefetch" href="/assets/js/137.80a4922f.js"><link rel="prefetch" href="/assets/js/138.32d47748.js"><link rel="prefetch" href="/assets/js/139.416dd598.js"><link rel="prefetch" href="/assets/js/14.0762709a.js"><link rel="prefetch" href="/assets/js/140.0526a1a7.js"><link rel="prefetch" href="/assets/js/141.6f0325a2.js"><link rel="prefetch" href="/assets/js/142.bdd0e4c7.js"><link rel="prefetch" href="/assets/js/143.989ea22a.js"><link rel="prefetch" href="/assets/js/144.a1cd1dc0.js"><link rel="prefetch" href="/assets/js/145.3e2bfabd.js"><link rel="prefetch" href="/assets/js/146.f3dc7600.js"><link rel="prefetch" href="/assets/js/147.b4137ccb.js"><link rel="prefetch" href="/assets/js/148.8fa664b9.js"><link rel="prefetch" href="/assets/js/149.a95d9a1a.js"><link rel="prefetch" href="/assets/js/15.1b80da4e.js"><link rel="prefetch" href="/assets/js/150.b64b947f.js"><link rel="prefetch" href="/assets/js/151.e9ccded1.js"><link rel="prefetch" href="/assets/js/152.2243e947.js"><link rel="prefetch" href="/assets/js/153.6b5342e4.js"><link rel="prefetch" href="/assets/js/154.aeb93cc6.js"><link rel="prefetch" href="/assets/js/155.177d0368.js"><link rel="prefetch" href="/assets/js/156.0dff7c18.js"><link rel="prefetch" href="/assets/js/157.0f96ffbd.js"><link rel="prefetch" href="/assets/js/158.5e72e814.js"><link rel="prefetch" href="/assets/js/159.2321aef6.js"><link rel="prefetch" href="/assets/js/16.2b887b64.js"><link rel="prefetch" href="/assets/js/160.8c8f491e.js"><link rel="prefetch" href="/assets/js/161.772e4950.js"><link rel="prefetch" href="/assets/js/162.622dbae1.js"><link rel="prefetch" href="/assets/js/163.9927a966.js"><link rel="prefetch" href="/assets/js/164.50a0f9b3.js"><link rel="prefetch" href="/assets/js/165.7b693ab0.js"><link rel="prefetch" href="/assets/js/166.6bb4ddfd.js"><link rel="prefetch" href="/assets/js/167.3bc534f1.js"><link rel="prefetch" href="/assets/js/168.4385d758.js"><link rel="prefetch" href="/assets/js/169.e6a0ccdd.js"><link rel="prefetch" href="/assets/js/170.66173677.js"><link rel="prefetch" href="/assets/js/171.b06fcd8c.js"><link rel="prefetch" href="/assets/js/172.21520ca8.js"><link rel="prefetch" href="/assets/js/173.d6327842.js"><link rel="prefetch" href="/assets/js/174.5a59cc08.js"><link rel="prefetch" href="/assets/js/175.31fd0d6e.js"><link rel="prefetch" href="/assets/js/176.22b3b134.js"><link rel="prefetch" href="/assets/js/177.352d3397.js"><link rel="prefetch" href="/assets/js/178.5fc22adc.js"><link rel="prefetch" href="/assets/js/179.2ba72c16.js"><link rel="prefetch" href="/assets/js/18.85a1f9a9.js"><link rel="prefetch" href="/assets/js/180.96581431.js"><link rel="prefetch" href="/assets/js/181.5f903e30.js"><link rel="prefetch" href="/assets/js/182.7607f654.js"><link rel="prefetch" href="/assets/js/183.399d4d59.js"><link rel="prefetch" href="/assets/js/184.29aa5e0a.js"><link rel="prefetch" href="/assets/js/185.8e87e256.js"><link rel="prefetch" href="/assets/js/186.cde6530c.js"><link rel="prefetch" href="/assets/js/187.4c2555eb.js"><link rel="prefetch" href="/assets/js/188.4df7e8c5.js"><link rel="prefetch" href="/assets/js/189.4429b18d.js"><link rel="prefetch" href="/assets/js/19.e39d49c8.js"><link rel="prefetch" href="/assets/js/190.6e9a784e.js"><link rel="prefetch" href="/assets/js/191.a624c3e1.js"><link rel="prefetch" href="/assets/js/192.c490e1bd.js"><link rel="prefetch" href="/assets/js/193.59407a91.js"><link rel="prefetch" href="/assets/js/194.9c5aac08.js"><link rel="prefetch" href="/assets/js/195.36bf7aa1.js"><link rel="prefetch" href="/assets/js/196.c8aa8c7a.js"><link rel="prefetch" href="/assets/js/197.2d4aff06.js"><link rel="prefetch" href="/assets/js/198.a59c1c7a.js"><link rel="prefetch" href="/assets/js/199.b542d754.js"><link rel="prefetch" href="/assets/js/20.7fe71cba.js"><link rel="prefetch" href="/assets/js/200.e9375be0.js"><link rel="prefetch" href="/assets/js/201.61c81d6b.js"><link rel="prefetch" href="/assets/js/202.98b05cda.js"><link rel="prefetch" href="/assets/js/203.37b5eda0.js"><link rel="prefetch" href="/assets/js/204.0069bb29.js"><link rel="prefetch" href="/assets/js/205.ae7f0d86.js"><link rel="prefetch" href="/assets/js/206.ec2b1d2a.js"><link rel="prefetch" href="/assets/js/207.5b05469f.js"><link rel="prefetch" href="/assets/js/208.abf7dfa9.js"><link rel="prefetch" href="/assets/js/209.45fec1ed.js"><link rel="prefetch" href="/assets/js/21.9922328f.js"><link rel="prefetch" href="/assets/js/210.dab2d9c7.js"><link rel="prefetch" href="/assets/js/211.60416e3b.js"><link rel="prefetch" href="/assets/js/212.3d35c6c1.js"><link rel="prefetch" href="/assets/js/213.c654ef1c.js"><link rel="prefetch" href="/assets/js/214.e90aaadc.js"><link rel="prefetch" href="/assets/js/215.3c6ff8e9.js"><link rel="prefetch" href="/assets/js/216.766e21a8.js"><link rel="prefetch" href="/assets/js/217.f1f8a6b7.js"><link rel="prefetch" href="/assets/js/218.6df04180.js"><link rel="prefetch" href="/assets/js/219.515ffb7b.js"><link rel="prefetch" href="/assets/js/22.8c1240f9.js"><link rel="prefetch" href="/assets/js/220.4f27759e.js"><link rel="prefetch" href="/assets/js/221.6e621cae.js"><link rel="prefetch" href="/assets/js/222.1872826a.js"><link rel="prefetch" href="/assets/js/223.08d0dbdc.js"><link rel="prefetch" href="/assets/js/224.b11985f8.js"><link rel="prefetch" href="/assets/js/225.5f07ecb1.js"><link rel="prefetch" href="/assets/js/226.6b1d6caf.js"><link rel="prefetch" href="/assets/js/227.734c3c2f.js"><link rel="prefetch" href="/assets/js/228.a055a7ae.js"><link rel="prefetch" href="/assets/js/229.a26dccb2.js"><link rel="prefetch" href="/assets/js/23.4fb3267a.js"><link rel="prefetch" href="/assets/js/230.6fecc6d5.js"><link rel="prefetch" href="/assets/js/231.281b82a7.js"><link rel="prefetch" href="/assets/js/232.9bdc1843.js"><link rel="prefetch" href="/assets/js/233.dc7d542b.js"><link rel="prefetch" href="/assets/js/234.c0c1b3f6.js"><link rel="prefetch" href="/assets/js/235.2f34d3ba.js"><link rel="prefetch" href="/assets/js/236.aa4f3adc.js"><link rel="prefetch" href="/assets/js/237.128d6ba2.js"><link rel="prefetch" href="/assets/js/238.9e2a7eb5.js"><link rel="prefetch" href="/assets/js/239.5246bc6c.js"><link rel="prefetch" href="/assets/js/24.06ec94ac.js"><link rel="prefetch" href="/assets/js/240.e09e2ea8.js"><link rel="prefetch" href="/assets/js/241.25e78043.js"><link rel="prefetch" href="/assets/js/242.0643d585.js"><link rel="prefetch" href="/assets/js/243.efbcbc1a.js"><link rel="prefetch" href="/assets/js/244.51445365.js"><link rel="prefetch" href="/assets/js/245.060cdd93.js"><link rel="prefetch" href="/assets/js/246.8d7a9e82.js"><link rel="prefetch" href="/assets/js/247.f457c7d6.js"><link rel="prefetch" href="/assets/js/248.dd3f92ec.js"><link rel="prefetch" href="/assets/js/249.3e5361fd.js"><link rel="prefetch" href="/assets/js/25.ed266ac3.js"><link rel="prefetch" href="/assets/js/250.0f2e4e49.js"><link rel="prefetch" href="/assets/js/251.a97c41be.js"><link rel="prefetch" href="/assets/js/252.6a20b059.js"><link rel="prefetch" href="/assets/js/253.721cee52.js"><link rel="prefetch" href="/assets/js/254.e8465042.js"><link rel="prefetch" href="/assets/js/255.3d68afa6.js"><link rel="prefetch" href="/assets/js/256.e5ae00ed.js"><link rel="prefetch" href="/assets/js/257.aff65644.js"><link rel="prefetch" href="/assets/js/258.09be3a0d.js"><link rel="prefetch" href="/assets/js/259.d2d1032b.js"><link rel="prefetch" href="/assets/js/26.d7ab2c9d.js"><link rel="prefetch" href="/assets/js/260.7035e77e.js"><link rel="prefetch" href="/assets/js/261.89a125c2.js"><link rel="prefetch" href="/assets/js/262.0dfc0b4c.js"><link rel="prefetch" href="/assets/js/263.0dce73dd.js"><link rel="prefetch" href="/assets/js/264.0b42f40c.js"><link rel="prefetch" href="/assets/js/265.04f55b6e.js"><link rel="prefetch" href="/assets/js/266.0729c717.js"><link rel="prefetch" href="/assets/js/267.58662450.js"><link rel="prefetch" href="/assets/js/268.2eb2f8f1.js"><link rel="prefetch" href="/assets/js/269.35f1b108.js"><link rel="prefetch" href="/assets/js/27.81c96578.js"><link rel="prefetch" href="/assets/js/270.b5a944da.js"><link rel="prefetch" href="/assets/js/271.fa7fe2d8.js"><link rel="prefetch" href="/assets/js/272.0c40c9d8.js"><link rel="prefetch" href="/assets/js/273.e4b7df48.js"><link rel="prefetch" href="/assets/js/274.c6e6cc20.js"><link rel="prefetch" href="/assets/js/275.b817e2aa.js"><link rel="prefetch" href="/assets/js/276.4a18bafe.js"><link rel="prefetch" href="/assets/js/277.60d91bd9.js"><link rel="prefetch" href="/assets/js/278.c750e185.js"><link rel="prefetch" href="/assets/js/279.3fc3a625.js"><link rel="prefetch" href="/assets/js/28.88ec39cf.js"><link rel="prefetch" href="/assets/js/280.c0a11d97.js"><link rel="prefetch" href="/assets/js/281.2d1b6454.js"><link rel="prefetch" href="/assets/js/282.64a14fc0.js"><link rel="prefetch" href="/assets/js/283.9d4eb8dc.js"><link rel="prefetch" href="/assets/js/284.82645d6c.js"><link rel="prefetch" href="/assets/js/285.0f6eef88.js"><link rel="prefetch" href="/assets/js/286.92a63bb3.js"><link rel="prefetch" href="/assets/js/287.4a963ff9.js"><link rel="prefetch" href="/assets/js/288.43b226b7.js"><link rel="prefetch" href="/assets/js/289.fbb855a6.js"><link rel="prefetch" href="/assets/js/29.a902dccf.js"><link rel="prefetch" href="/assets/js/290.cff02d18.js"><link rel="prefetch" href="/assets/js/291.4934394d.js"><link rel="prefetch" href="/assets/js/292.92846ba5.js"><link rel="prefetch" href="/assets/js/293.a2e9ee13.js"><link rel="prefetch" href="/assets/js/294.a67fe767.js"><link rel="prefetch" href="/assets/js/295.4ca17b5a.js"><link rel="prefetch" href="/assets/js/296.4c0f5ae0.js"><link rel="prefetch" href="/assets/js/297.aef0d63f.js"><link rel="prefetch" href="/assets/js/298.d6edf105.js"><link rel="prefetch" href="/assets/js/299.7ee51718.js"><link rel="prefetch" href="/assets/js/30.a84dfa18.js"><link rel="prefetch" href="/assets/js/300.65a7961d.js"><link rel="prefetch" href="/assets/js/301.061dfa99.js"><link rel="prefetch" href="/assets/js/302.a50e5559.js"><link rel="prefetch" href="/assets/js/303.41e7e42e.js"><link rel="prefetch" href="/assets/js/304.fd204f7b.js"><link rel="prefetch" href="/assets/js/305.993cf223.js"><link rel="prefetch" href="/assets/js/306.08fcec1e.js"><link rel="prefetch" href="/assets/js/307.e2ed0370.js"><link rel="prefetch" href="/assets/js/308.1fe08907.js"><link rel="prefetch" href="/assets/js/309.b058a916.js"><link rel="prefetch" href="/assets/js/31.d9635fcc.js"><link rel="prefetch" href="/assets/js/310.afda4f9e.js"><link rel="prefetch" href="/assets/js/311.1d0ecc22.js"><link rel="prefetch" href="/assets/js/312.a29741bd.js"><link rel="prefetch" href="/assets/js/313.7191f6e1.js"><link rel="prefetch" href="/assets/js/314.13a93c71.js"><link rel="prefetch" href="/assets/js/315.05d9bd9d.js"><link rel="prefetch" href="/assets/js/316.574f092c.js"><link rel="prefetch" href="/assets/js/317.984dcba3.js"><link rel="prefetch" href="/assets/js/318.c3c8a7ac.js"><link rel="prefetch" href="/assets/js/319.424053ad.js"><link rel="prefetch" href="/assets/js/32.73c8cf2b.js"><link rel="prefetch" href="/assets/js/320.b76cfc49.js"><link rel="prefetch" href="/assets/js/321.78562076.js"><link rel="prefetch" href="/assets/js/322.8cdb7e92.js"><link rel="prefetch" href="/assets/js/323.bdaf3b91.js"><link rel="prefetch" href="/assets/js/324.780a105e.js"><link rel="prefetch" href="/assets/js/325.3733ca3e.js"><link rel="prefetch" href="/assets/js/326.5ef0fea9.js"><link rel="prefetch" href="/assets/js/327.4c11df8d.js"><link rel="prefetch" href="/assets/js/328.0145cdae.js"><link rel="prefetch" href="/assets/js/329.e59e39e0.js"><link rel="prefetch" href="/assets/js/33.6bdee2d5.js"><link rel="prefetch" href="/assets/js/330.15b96302.js"><link rel="prefetch" href="/assets/js/331.0a0c3662.js"><link rel="prefetch" href="/assets/js/332.fa9a1d88.js"><link rel="prefetch" href="/assets/js/333.ed946251.js"><link rel="prefetch" href="/assets/js/334.d02ea4fc.js"><link rel="prefetch" href="/assets/js/335.4d4fad79.js"><link rel="prefetch" href="/assets/js/336.379bf12f.js"><link rel="prefetch" href="/assets/js/337.e7e789dd.js"><link rel="prefetch" href="/assets/js/338.e30331cf.js"><link rel="prefetch" href="/assets/js/339.d878e58a.js"><link rel="prefetch" href="/assets/js/34.953882cd.js"><link rel="prefetch" href="/assets/js/340.e804df99.js"><link rel="prefetch" href="/assets/js/341.4883698b.js"><link rel="prefetch" href="/assets/js/342.60c282ee.js"><link rel="prefetch" href="/assets/js/343.0debdc68.js"><link rel="prefetch" href="/assets/js/344.e07b9ccb.js"><link rel="prefetch" href="/assets/js/345.0d7f029b.js"><link rel="prefetch" href="/assets/js/346.ac00eb11.js"><link rel="prefetch" href="/assets/js/347.24ce4a6f.js"><link rel="prefetch" href="/assets/js/348.2481b85c.js"><link rel="prefetch" href="/assets/js/349.cbd48778.js"><link rel="prefetch" href="/assets/js/35.0852d7b4.js"><link rel="prefetch" href="/assets/js/350.41d01d59.js"><link rel="prefetch" href="/assets/js/351.f19ab35f.js"><link rel="prefetch" href="/assets/js/352.590b4f3b.js"><link rel="prefetch" href="/assets/js/353.006fa233.js"><link rel="prefetch" href="/assets/js/354.36e541e7.js"><link rel="prefetch" href="/assets/js/355.81d1e75d.js"><link rel="prefetch" href="/assets/js/356.6f2cd51e.js"><link rel="prefetch" href="/assets/js/357.4ff734f8.js"><link rel="prefetch" href="/assets/js/358.00f10c1f.js"><link rel="prefetch" href="/assets/js/359.16872668.js"><link rel="prefetch" href="/assets/js/36.619c2ddf.js"><link rel="prefetch" href="/assets/js/360.acf621ae.js"><link rel="prefetch" href="/assets/js/361.7fd65d2c.js"><link rel="prefetch" href="/assets/js/362.60360c20.js"><link rel="prefetch" href="/assets/js/363.71f7487d.js"><link rel="prefetch" href="/assets/js/364.c8654577.js"><link rel="prefetch" href="/assets/js/365.d3f30e94.js"><link rel="prefetch" href="/assets/js/366.2c0faccb.js"><link rel="prefetch" href="/assets/js/367.c13b3e72.js"><link rel="prefetch" href="/assets/js/368.f2f74ca6.js"><link rel="prefetch" href="/assets/js/369.1162708e.js"><link rel="prefetch" href="/assets/js/37.02dca668.js"><link rel="prefetch" href="/assets/js/370.88f3e6c0.js"><link rel="prefetch" href="/assets/js/371.fb156999.js"><link rel="prefetch" href="/assets/js/372.284ce8d3.js"><link rel="prefetch" href="/assets/js/373.6f14e18d.js"><link rel="prefetch" href="/assets/js/374.afd537e0.js"><link rel="prefetch" href="/assets/js/375.78487da1.js"><link rel="prefetch" href="/assets/js/376.f8d881b6.js"><link rel="prefetch" href="/assets/js/377.03505cdf.js"><link rel="prefetch" href="/assets/js/378.ab4daf5f.js"><link rel="prefetch" href="/assets/js/379.3edd1e3f.js"><link rel="prefetch" href="/assets/js/38.f24a049a.js"><link rel="prefetch" href="/assets/js/380.41988c3a.js"><link rel="prefetch" href="/assets/js/381.cc441500.js"><link rel="prefetch" href="/assets/js/382.2c745fa1.js"><link rel="prefetch" href="/assets/js/383.fe50deef.js"><link rel="prefetch" href="/assets/js/384.ba5d5e8c.js"><link rel="prefetch" href="/assets/js/385.ad631a63.js"><link rel="prefetch" href="/assets/js/386.78c51913.js"><link rel="prefetch" href="/assets/js/387.124d6321.js"><link rel="prefetch" href="/assets/js/388.7b1d976a.js"><link rel="prefetch" href="/assets/js/389.1526c915.js"><link rel="prefetch" href="/assets/js/39.e93d1116.js"><link rel="prefetch" href="/assets/js/390.f299db71.js"><link rel="prefetch" href="/assets/js/391.b1ae8926.js"><link rel="prefetch" href="/assets/js/392.8040fde6.js"><link rel="prefetch" href="/assets/js/393.5ff07e01.js"><link rel="prefetch" href="/assets/js/394.a953b9fb.js"><link rel="prefetch" href="/assets/js/395.f2bc47bf.js"><link rel="prefetch" href="/assets/js/396.9fbd473c.js"><link rel="prefetch" href="/assets/js/397.433c40ad.js"><link rel="prefetch" href="/assets/js/398.88cc4861.js"><link rel="prefetch" href="/assets/js/399.53260b2b.js"><link rel="prefetch" href="/assets/js/4.5a25ddbf.js"><link rel="prefetch" href="/assets/js/40.0f8ce7f4.js"><link rel="prefetch" href="/assets/js/400.9403b232.js"><link rel="prefetch" href="/assets/js/401.401d4489.js"><link rel="prefetch" href="/assets/js/402.44a1a7e8.js"><link rel="prefetch" href="/assets/js/403.7a5da60c.js"><link rel="prefetch" href="/assets/js/404.c33d6d74.js"><link rel="prefetch" href="/assets/js/405.9f0804d4.js"><link rel="prefetch" href="/assets/js/406.a4c9944b.js"><link rel="prefetch" href="/assets/js/407.517f8455.js"><link rel="prefetch" href="/assets/js/408.d9e814ec.js"><link rel="prefetch" href="/assets/js/409.e9616856.js"><link rel="prefetch" href="/assets/js/41.ccc29c48.js"><link rel="prefetch" href="/assets/js/410.983a85bc.js"><link rel="prefetch" href="/assets/js/411.411e249f.js"><link rel="prefetch" href="/assets/js/412.e571ade3.js"><link rel="prefetch" href="/assets/js/413.0d4b8408.js"><link rel="prefetch" href="/assets/js/414.adf8fdcc.js"><link rel="prefetch" href="/assets/js/415.ec147e45.js"><link rel="prefetch" href="/assets/js/416.9435f832.js"><link rel="prefetch" href="/assets/js/417.011f12e9.js"><link rel="prefetch" href="/assets/js/418.14be8263.js"><link rel="prefetch" href="/assets/js/419.278cdf2e.js"><link rel="prefetch" href="/assets/js/42.9520d0af.js"><link rel="prefetch" href="/assets/js/420.acc6dc7f.js"><link rel="prefetch" href="/assets/js/421.4eb42b7a.js"><link rel="prefetch" href="/assets/js/422.a5cdae86.js"><link rel="prefetch" href="/assets/js/423.b050f3d8.js"><link rel="prefetch" href="/assets/js/424.674a3dba.js"><link rel="prefetch" href="/assets/js/425.cca946f0.js"><link rel="prefetch" href="/assets/js/426.658fb3cc.js"><link rel="prefetch" href="/assets/js/427.77bcaef5.js"><link rel="prefetch" href="/assets/js/428.e552f5d8.js"><link rel="prefetch" href="/assets/js/429.00066df5.js"><link rel="prefetch" href="/assets/js/43.7ab8439d.js"><link rel="prefetch" href="/assets/js/430.b9e0183d.js"><link rel="prefetch" href="/assets/js/431.515b4ffb.js"><link rel="prefetch" href="/assets/js/432.78e87efd.js"><link rel="prefetch" href="/assets/js/433.671ab62f.js"><link rel="prefetch" href="/assets/js/434.225e0cb0.js"><link rel="prefetch" href="/assets/js/435.85516d0a.js"><link rel="prefetch" href="/assets/js/436.56e07937.js"><link rel="prefetch" href="/assets/js/437.af5e3bbf.js"><link rel="prefetch" href="/assets/js/438.157cc9f4.js"><link rel="prefetch" href="/assets/js/439.b3374492.js"><link rel="prefetch" href="/assets/js/44.1c303d8d.js"><link rel="prefetch" href="/assets/js/440.1d24c2b3.js"><link rel="prefetch" href="/assets/js/441.e53640a6.js"><link rel="prefetch" href="/assets/js/442.2c61970b.js"><link rel="prefetch" href="/assets/js/443.5fb6e00d.js"><link rel="prefetch" href="/assets/js/444.bc75ae9d.js"><link rel="prefetch" href="/assets/js/445.cd3c39a0.js"><link rel="prefetch" href="/assets/js/446.ca4b16d0.js"><link rel="prefetch" href="/assets/js/45.5ec64ef6.js"><link rel="prefetch" href="/assets/js/46.d12e6234.js"><link rel="prefetch" href="/assets/js/47.cb797230.js"><link rel="prefetch" href="/assets/js/48.21c7a4be.js"><link rel="prefetch" href="/assets/js/49.f21bee72.js"><link rel="prefetch" href="/assets/js/5.66d1f4bf.js"><link rel="prefetch" href="/assets/js/50.3a322428.js"><link rel="prefetch" href="/assets/js/51.4aa20c83.js"><link rel="prefetch" href="/assets/js/52.1f0eda6c.js"><link rel="prefetch" href="/assets/js/53.8520e8d1.js"><link rel="prefetch" href="/assets/js/54.8a6fffcd.js"><link rel="prefetch" href="/assets/js/55.f1ca057f.js"><link rel="prefetch" href="/assets/js/56.818e5f7a.js"><link rel="prefetch" href="/assets/js/57.0eb3594f.js"><link rel="prefetch" href="/assets/js/58.5b5fd51f.js"><link rel="prefetch" href="/assets/js/59.5a5c2d67.js"><link rel="prefetch" href="/assets/js/6.9d118111.js"><link rel="prefetch" href="/assets/js/60.47165958.js"><link rel="prefetch" href="/assets/js/61.d2661a82.js"><link rel="prefetch" href="/assets/js/62.7ec6ef68.js"><link rel="prefetch" href="/assets/js/63.31e761d6.js"><link rel="prefetch" href="/assets/js/64.593f408d.js"><link rel="prefetch" href="/assets/js/65.b1a1cbde.js"><link rel="prefetch" href="/assets/js/66.59e4f7a4.js"><link rel="prefetch" href="/assets/js/67.79b112df.js"><link rel="prefetch" href="/assets/js/68.a102a314.js"><link rel="prefetch" href="/assets/js/69.e5639fe9.js"><link rel="prefetch" href="/assets/js/7.85d66dd3.js"><link rel="prefetch" href="/assets/js/70.5f243356.js"><link rel="prefetch" href="/assets/js/71.cb484093.js"><link rel="prefetch" href="/assets/js/72.5478dab2.js"><link rel="prefetch" href="/assets/js/73.1a521adc.js"><link rel="prefetch" href="/assets/js/74.d613174c.js"><link rel="prefetch" href="/assets/js/75.2d742c66.js"><link rel="prefetch" href="/assets/js/76.49e6c66d.js"><link rel="prefetch" href="/assets/js/77.3ba67cd5.js"><link rel="prefetch" href="/assets/js/78.e54e960d.js"><link rel="prefetch" href="/assets/js/79.790cf562.js"><link rel="prefetch" href="/assets/js/8.2e49c233.js"><link rel="prefetch" href="/assets/js/80.92376c8d.js"><link rel="prefetch" href="/assets/js/81.ca138ca9.js"><link rel="prefetch" href="/assets/js/82.575a67d9.js"><link rel="prefetch" href="/assets/js/83.d86c343e.js"><link rel="prefetch" href="/assets/js/84.7b46bd87.js"><link rel="prefetch" href="/assets/js/85.957bd970.js"><link rel="prefetch" href="/assets/js/86.a5f655e8.js"><link rel="prefetch" href="/assets/js/87.112080ec.js"><link rel="prefetch" href="/assets/js/88.6d522517.js"><link rel="prefetch" href="/assets/js/89.31c1fa0d.js"><link rel="prefetch" href="/assets/js/9.0388f7c2.js"><link rel="prefetch" href="/assets/js/90.0627a72e.js"><link rel="prefetch" href="/assets/js/91.5bfc873a.js"><link rel="prefetch" href="/assets/js/92.54161922.js"><link rel="prefetch" href="/assets/js/93.222c7298.js"><link rel="prefetch" href="/assets/js/94.2fdeec0a.js"><link rel="prefetch" href="/assets/js/95.e800de2a.js"><link rel="prefetch" href="/assets/js/96.0da22ea7.js"><link rel="prefetch" href="/assets/js/97.14f23b97.js"><link rel="prefetch" href="/assets/js/98.590467e2.js"><link rel="prefetch" href="/assets/js/99.7105fe68.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.c6292dad.js">
    <link rel="stylesheet" href="/assets/css/0.styles.f6f54dc7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">QueryPHP</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Docs" class="dropdown-title"><span class="title">Docs</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/" class="nav-link router-link-active">
  Preface
</a></li><li class="dropdown-item"><!----> <a href="/docs/started/" class="nav-link">
  Started
</a></li><li class="dropdown-item"><!----> <a href="/docs/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/docs/architecture/" class="nav-link router-link-active">
  Architecture
</a></li><li class="dropdown-item"><!----> <a href="/docs/router/" class="nav-link">
  Routing
</a></li><li class="dropdown-item"><!----> <a href="/docs/template/" class="nav-link">
  Template
</a></li><li class="dropdown-item"><!----> <a href="/docs/database/" class="nav-link">
  Database
</a></li><li class="dropdown-item"><!----> <a href="/docs/orm/" class="nav-link">
  ORM
</a></li><li class="dropdown-item"><!----> <a href="/docs/validate/" class="nav-link">
  Validate
</a></li><li class="dropdown-item"><!----> <a href="/docs/protocol/coroutine.html" class="nav-link">
  Protocol
</a></li><li class="dropdown-item"><!----> <a href="/docs/component/support/str.html" class="nav-link">
  Component
</a></li><li class="dropdown-item"><!----> <a href="/docs/test/" class="nav-link">
  Test
</a></li><li class="dropdown-item"><!----> <a href="/docs/developer/" class="nav-link">
  Developer
</a></li></ul></div></div><div class="nav-item"><a href="/ecosystem/" class="nav-link">
  Community
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About Us
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/architecture/ioc.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh-CN/docs/architecture/ioc.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/hunzhiwange/queryphp.com" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Docs" class="dropdown-title"><span class="title">Docs</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/" class="nav-link router-link-active">
  Preface
</a></li><li class="dropdown-item"><!----> <a href="/docs/started/" class="nav-link">
  Started
</a></li><li class="dropdown-item"><!----> <a href="/docs/guide/" class="nav-link">
  Guide
</a></li><li class="dropdown-item"><!----> <a href="/docs/architecture/" class="nav-link router-link-active">
  Architecture
</a></li><li class="dropdown-item"><!----> <a href="/docs/router/" class="nav-link">
  Routing
</a></li><li class="dropdown-item"><!----> <a href="/docs/template/" class="nav-link">
  Template
</a></li><li class="dropdown-item"><!----> <a href="/docs/database/" class="nav-link">
  Database
</a></li><li class="dropdown-item"><!----> <a href="/docs/orm/" class="nav-link">
  ORM
</a></li><li class="dropdown-item"><!----> <a href="/docs/validate/" class="nav-link">
  Validate
</a></li><li class="dropdown-item"><!----> <a href="/docs/protocol/coroutine.html" class="nav-link">
  Protocol
</a></li><li class="dropdown-item"><!----> <a href="/docs/component/support/str.html" class="nav-link">
  Component
</a></li><li class="dropdown-item"><!----> <a href="/docs/test/" class="nav-link">
  Test
</a></li><li class="dropdown-item"><!----> <a href="/docs/developer/" class="nav-link">
  Developer
</a></li></ul></div></div><div class="nav-item"><a href="/ecosystem/" class="nav-link">
  Community
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  About Us
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Languages" class="dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/architecture/ioc.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/zh-CN/docs/architecture/ioc.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/hunzhiwange/queryphp.com" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Architecture</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/architecture/" aria-current="page" class="sidebar-link">Summary</a></li><li><a href="/docs/architecture/ioc.html" aria-current="page" class="active sidebar-link">IOC 容器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#闭包绑定" class="sidebar-link">闭包绑定</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#闭包绑定单例" class="sidebar-link">闭包绑定单例</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#类直接生成本身" class="sidebar-link">类直接生成本身</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#类单例" class="sidebar-link">类单例</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#接口绑定" class="sidebar-link">接口绑定</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#接口绑定接口作为构造器参数" class="sidebar-link">接口绑定接口作为构造器参数</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#绑定闭包第一个参数为-ioc-容器本身" class="sidebar-link">绑定闭包第一个参数为 IOC 容器本身</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#数组访问-arrayaccess-支持" class="sidebar-link">数组访问 ArrayAccess 支持</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#alias-设置别名" class="sidebar-link">alias 设置别名</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#make-创建容器服务并返回支持参数" class="sidebar-link">make 创建容器服务并返回支持参数</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#bind-注册到容器支持覆盖" class="sidebar-link">bind 注册到容器支持覆盖</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#instance-注册为实例" class="sidebar-link">instance 注册为实例</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#默认参数支持" class="sidebar-link">默认参数支持</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#必填参数校验" class="sidebar-link">必填参数校验</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#接口必须绑定服务" class="sidebar-link">接口必须绑定服务</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#call-回调自动依赖注入" class="sidebar-link">call 回调自动依赖注入</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#call-回调自动依赖注入支持字符串或者数组类回调" class="sidebar-link">call 回调自动依赖注入支持字符串或者数组类回调</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#call-回调自动依赖注入支持实例和方法数组回调" class="sidebar-link">call 回调自动依赖注入支持实例和方法数组回调</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#call-回调自动依赖注入支持静态回调" class="sidebar-link">call 回调自动依赖注入支持静态回调</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#remove-删除服务和实例" class="sidebar-link">remove 删除服务和实例</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#实例数组访问-arrayaccess-offsetunset-支持" class="sidebar-link">实例数组访问 ArrayAccess.offsetUnset 支持</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#类依赖注入构造器必须为-public" class="sidebar-link">类依赖注入构造器必须为 public</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#bind-注册到容器可以支持各种数据" class="sidebar-link">bind 注册到容器可以支持各种数据</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#bind-注册到容器支持传递数组来设置别名" class="sidebar-link">bind 注册到容器支持传递数组来设置别名</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#依赖注入的方法中类参数不存在例子" class="sidebar-link">依赖注入的方法中类参数不存在例子</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#instance-注册为实例支持传递数组来设置别名" class="sidebar-link">instance 注册为实例支持传递数组来设置别名</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#instance-注册为实例未传递第二个参数会注册自身" class="sidebar-link">instance 注册为实例未传递第二个参数会注册自身</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#参数为类实例例子" class="sidebar-link">参数为类实例例子</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#参数为类实例例子和其它参数混合" class="sidebar-link">参数为类实例例子和其它参数混合</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#make-创建容器服务并返回支持类名生成服务" class="sidebar-link">make 创建容器服务并返回支持类名生成服务</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#魔术方法-get-支持" class="sidebar-link">魔术方法 __get 支持</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#魔术方法-set-支持" class="sidebar-link">魔术方法 __set 支持</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#clear-清理容器" class="sidebar-link">clear 清理容器</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#ioc-容器禁止克隆" class="sidebar-link">IOC 容器禁止克隆</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#makeprovider-创建服务提供者" class="sidebar-link">makeProvider 创建服务提供者</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#callproviderbootstrap-执行服务提供者-bootstrap" class="sidebar-link">callProviderBootstrap 执行服务提供者 bootstrap</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#registerproviders-注册服务提供者" class="sidebar-link">registerProviders 注册服务提供者</a></li><li class="sidebar-sub-header"><a href="/docs/architecture/ioc.html#registerproviders-注册服务提供者支持延迟写入" class="sidebar-link">registerProviders 注册服务提供者支持延迟写入</a></li></ul></li><li><a href="/docs/architecture/provider.html" class="sidebar-link">服务提供者</a></li><li><a href="/docs/architecture/fn.html" class="sidebar-link">函数惰性加载</a></li><li><a href="/docs/architecture/event.html" class="sidebar-link">事件</a></li><li><a href="/docs/architecture/manager.html" class="sidebar-link">Manager</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>Kernel</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ioc-容器"><a href="#ioc-容器" class="header-anchor">#</a> IOC 容器</h1> <div class="custom-block tip"><p class="custom-block-title">Testing Is Documentation</p> <p><a href="https://github.com/hunzhiwange/framework/blob/master/tests/Di/ContainerTest.php" target="_blank" rel="noopener noreferrer">tests/Di/ContainerTest.php<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></div> <p>IOC 容器是整个框架最核心的部分，负责服务的管理和解耦。</p> <p>目前系统所有的关键服务都接入了 IOC 容器，包括控制器、Console 命令行。</p> <p><strong>Uses</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">use</span> <span class="token package">Leevel<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Container</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">stdClass</span><span class="token punctuation">;</span>
</span></code></pre></div><h2 id="闭包绑定"><a href="#闭包绑定" class="header-anchor">#</a> 闭包绑定</h2> <p>闭包属于惰性，真正使用的时候才会执行。</p> <p>我们可以通过 <code>bind</code> 来绑定一个闭包，通过 <code>make</code> 来运行服务，第二次运行如果是单例则直接使用生成后的结果，否则会每次执行闭包的代码。</p> <p>通常来说，系统大部分服务都是单例来提升性能和共享。</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testBindClosure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="闭包绑定单例"><a href="#闭包绑定单例" class="header-anchor">#</a> 闭包绑定单例</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testSingletonClosure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$singleton</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">stdClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">singleton</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'singleton'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">use</span> <span class="token punctuation">(</span><span class="token variable">$singleton</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$singleton</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token variable">$singleton</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'singleton'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token variable">$singleton</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'singleton'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="类直接生成本身"><a href="#类直接生成本身" class="header-anchor">#</a> 类直接生成本身</h2> <p>一个独立的类可以直接生成，而不需要提前注册到容器中。</p> <p><strong>fixture 定义</strong></p> <p><strong>Tests\Di\Fixtures\Test1</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test1</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertInstanceOf</span><span class="token punctuation">(</span>Test1<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span>Test1<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="类单例"><a href="#类单例" class="header-anchor">#</a> 类单例</h2> <p>类也可以注册为单例。</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testSingletonClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">singleton</span><span class="token punctuation">(</span>Test1<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span>Test1<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span>Test1<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="接口绑定"><a href="#接口绑定" class="header-anchor">#</a> 接口绑定</h2> <p>可以为接口绑定实现。</p> <p><strong>fixture 定义</strong></p> <p><strong>Tests\Di\Fixtures\ITest2</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">ITest2</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Tests\Di\Fixtures\Test2</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test2</span> <span class="token keyword">implements</span> <span class="token class-name">ITest2</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testInterface</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span>ITest2<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> Test2<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertInstanceOf</span><span class="token punctuation">(</span>ITest2<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span>ITest2<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertInstanceOf</span><span class="token punctuation">(</span>ITest2<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span>Test2<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="接口绑定接口作为构造器参数"><a href="#接口绑定接口作为构造器参数" class="header-anchor">#</a> 接口绑定接口作为构造器参数</h2> <p>接口可以作为控制器参数来做依赖注入。</p> <p><strong>fixture 定义</strong></p> <p><strong>Tests\Di\Fixtures\Test3</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test3</span> <span class="token keyword">implements</span> <span class="token class-name">ITest3</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$arg1</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span>ITest2 <span class="token variable">$arg1</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">arg1</span> <span class="token operator">=</span> <span class="token variable">$arg1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>通过 <code>Test3</code> 的构造函数注入 <code>ITest2</code> 的实现 <code>Test2</code>，通过 IOC 容器可以实现代码解耦。</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testInterface2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span>ITest2<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> Test2<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertInstanceOf</span><span class="token punctuation">(</span>ITest2<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token variable">$test2</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span>Test3<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">arg1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertInstanceOf</span><span class="token punctuation">(</span>Test2<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token variable">$test2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="绑定闭包第一个参数为-ioc-容器本身"><a href="#绑定闭包第一个参数为-ioc-容器本身" class="header-anchor">#</a> 绑定闭包第一个参数为 IOC 容器本身</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testContainerAsFirstArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'test'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$container</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$container</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'test'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="数组访问-arrayaccess-支持"><a href="#数组访问-arrayaccess-支持" class="header-anchor">#</a> 数组访问 ArrayAccess 支持</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testArrayAccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertTrue</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertFalse</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="alias-设置别名"><a href="#alias-设置别名" class="header-anchor">#</a> alias 设置别名</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testAliases</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">alias</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'foo2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">alias</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'foo3'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'foo4'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">alias</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'foo5'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'foo6'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">alias</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'foo7'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo2'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo3'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo4'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo5'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo6'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo7'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="make-创建容器服务并返回支持参数"><a href="#make-创建容器服务并返回支持参数" class="header-anchor">#</a> make 创建容器服务并返回支持参数</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testMakeWithArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$container</span><span class="token punctuation">,</span> <span class="token variable">$arg1</span><span class="token punctuation">,</span> <span class="token variable">$arg2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span>
            <span class="token variable">$arg1</span><span class="token punctuation">,</span>
            <span class="token variable">$arg2</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="bind-注册到容器支持覆盖"><a href="#bind-注册到容器支持覆盖" class="header-anchor">#</a> bind 注册到容器支持覆盖</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testOverridden</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'bar2'</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar2'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="instance-注册为实例"><a href="#instance-注册为实例" class="header-anchor">#</a> instance 注册为实例</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$instance</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">stdClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">instance</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token variable">$instance</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token variable">$instance</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="默认参数支持"><a href="#默认参数支持" class="header-anchor">#</a> 默认参数支持</h2> <p><strong>fixture 定义</strong></p> <p><strong>Tests\Di\Fixtures\Test5</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test5</span> <span class="token keyword">implements</span> <span class="token class-name">ITest3</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$arg1</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token variable">$arg2</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span>Test3 <span class="token variable">$arg1</span><span class="token punctuation">,</span> <span class="token variable">$arg2</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'hello default'</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">arg1</span> <span class="token operator">=</span> <span class="token variable">$arg1</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">arg2</span> <span class="token operator">=</span> <span class="token variable">$arg2</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Tests\Di\Fixtures\ITest3</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">ITest3</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testDefaultArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span>ITest2<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> Test2<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> Test5<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$test5</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertInstanceOf</span><span class="token punctuation">(</span>ITest3<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token variable">$test5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'hello default'</span><span class="token punctuation">,</span> <span class="token variable">$test5</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">arg2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="必填参数校验"><a href="#必填参数校验" class="header-anchor">#</a> 必填参数校验</h2> <p><strong>fixture 定义</strong></p> <p><strong>Tests\Di\Fixtures\Test6</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test6</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$arg1</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token variable">$arg2</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token variable">$arg3</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$arg1</span><span class="token punctuation">,</span> <span class="token variable">$arg2</span><span class="token punctuation">,</span> <span class="token variable">$arg3</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">arg1</span> <span class="token operator">=</span> <span class="token variable">$arg1</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">arg2</span> <span class="token operator">=</span> <span class="token variable">$arg2</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">arg3</span> <span class="token operator">=</span> <span class="token variable">$arg3</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testArgsRequiredContainerInvalidArgumentException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">expectException</span><span class="token punctuation">(</span>\<span class="token package">Leevel<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>ContainerInvalidArgumentException</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">expectExceptionMessage</span><span class="token punctuation">(</span>
        <span class="token single-quoted-string string">'There are 3 required args,but 0 gived.'</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span>Test6<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="接口必须绑定服务"><a href="#接口必须绑定服务" class="header-anchor">#</a> 接口必须绑定服务</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testInterfaceContainerInvalidArgumentException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">expectException</span><span class="token punctuation">(</span>\<span class="token package">Leevel<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>ContainerInvalidArgumentException</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">expectExceptionMessage</span><span class="token punctuation">(</span>
        <span class="token single-quoted-string string">'Interface Tests\\Di\\Fixtures\\ITest2 cannot be normalize because not binded.'</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span>ITest2<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="call-回调自动依赖注入"><a href="#call-回调自动依赖注入" class="header-anchor">#</a> call 回调自动依赖注入</h2> <p><strong>fixture 定义</strong></p> <p><strong>Tests\Di\Fixtures\Test7</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test7</span>
<span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Tests\Di\Fixtures\Test8</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test8</span> <span class="token keyword">implements</span> <span class="token class-name">ITest8</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">func_get_args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token variable">$arg1</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'hello'</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">func_get_args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">staticFunc3</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">func_get_args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'call handle'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testCall</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>Test7 <span class="token variable">$arg1</span><span class="token punctuation">,</span> <span class="token keyword">array</span> <span class="token variable">$arg2</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">func_get_args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertInstanceOf</span><span class="token punctuation">(</span>Test7<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>Test7 <span class="token variable">$arg1</span><span class="token punctuation">,</span> <span class="token keyword">array</span> <span class="token variable">$arg2</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$arg3</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">func_get_args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'arg3'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'hello'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertInstanceOf</span><span class="token punctuation">(</span>Test7<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'hello'</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$test7</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test7</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span>Test7 <span class="token variable">$arg1</span><span class="token punctuation">,</span> <span class="token variable">$arg2</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'hello'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">func_get_args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>Test7<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$test7</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'arg2'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'hello world'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token variable">$test7</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'hello world'</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$test8</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$arg1</span><span class="token punctuation">,</span> <span class="token variable">$arg2</span><span class="token punctuation">,</span> <span class="token variable">$arg3</span><span class="token punctuation">,</span> <span class="token operator">?</span>ITest8 <span class="token variable">$arg4</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token operator">?</span>Test8 <span class="token variable">$arg5</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">func_get_args</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'arg1'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'arg3'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'world2'</span><span class="token punctuation">,</span> Test8<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$test8</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertNull</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'world2'</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertNull</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$test8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="call-回调自动依赖注入支持字符串或者数组类回调"><a href="#call-回调自动依赖注入支持字符串或者数组类回调" class="header-anchor">#</a> call 回调自动依赖注入支持字符串或者数组类回调</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testCallWithArrayOrString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span>Test8<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'func1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span>Test8<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token single-quoted-string string">'@func1'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span>Test8<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'call handle'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span>Test8<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token single-quoted-string string">'@'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'call handle'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span>Test8<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token single-quoted-string string">'@func2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'hello'</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span>Test8<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token single-quoted-string string">'@func2'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'world'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'world'</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span>Test8<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token single-quoted-string string">'@func2'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'world'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'arg1'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'world'</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="call-回调自动依赖注入支持实例和方法数组回调"><a href="#call-回调自动依赖注入支持实例和方法数组回调" class="header-anchor">#</a> call 回调自动依赖注入支持实例和方法数组回调</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testCallWithCallableArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$test8</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token variable">$test8</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'func1'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="call-回调自动依赖注入支持静态回调"><a href="#call-回调自动依赖注入支持静态回调" class="header-anchor">#</a> call 回调自动依赖注入支持静态回调</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testCallStatic</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span>Test8<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token single-quoted-string string">'::staticFunc3'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'hello'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'world'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'hello'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'world'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="remove-删除服务和实例"><a href="#remove-删除服务和实例" class="header-anchor">#</a> remove 删除服务和实例</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testRemove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$test8</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test8</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">instance</span><span class="token punctuation">(</span>Test8<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token variable">$test8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertTrue</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">exists</span><span class="token punctuation">(</span>Test8<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">remove</span><span class="token punctuation">(</span>Test8<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertFalse</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">exists</span><span class="token punctuation">(</span>Test8<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="实例数组访问-arrayaccess-offsetunset-支持"><a href="#实例数组访问-arrayaccess-offsetunset-支持" class="header-anchor">#</a> 实例数组访问 ArrayAccess.offsetUnset 支持</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testUnsetInstances</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">instance</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">alias</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'foo2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">alias</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'foo3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertTrue</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertTrue</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertTrue</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertFalse</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertFalse</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertFalse</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo3'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="类依赖注入构造器必须为-public"><a href="#类依赖注入构造器必须为-public" class="header-anchor">#</a> 类依赖注入构造器必须为 public</h2> <p><strong>fixture 定义</strong></p> <p><strong>Tests\Di\Fixtures\Test9</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test9</span>
<span class="token punctuation">{</span>
    <span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token single-quoted-string string">'world9'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testNotInstantiable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">expectException</span><span class="token punctuation">(</span>\<span class="token package">InvalidArgumentException</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">expectExceptionMessage</span><span class="token punctuation">(</span>
        <span class="token single-quoted-string string">'Class Tests\\Di\\Fixtures\\Test9 is not instantiable.'</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'world9'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span>Test9<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="bind-注册到容器可以支持各种数据"><a href="#bind-注册到容器可以支持各种数据" class="header-anchor">#</a> bind 注册到容器可以支持各种数据</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testMakeServiceBool</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token boolean constant">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertFalse</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="bind-注册到容器支持传递数组来设置别名"><a href="#bind-注册到容器支持传递数组来设置别名" class="header-anchor">#</a> bind 注册到容器支持传递数组来设置别名</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testBindArrayAsAlias</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token boolean constant">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertFalse</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertFalse</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="依赖注入的方法中类参数不存在例子"><a href="#依赖注入的方法中类参数不存在例子" class="header-anchor">#</a> 依赖注入的方法中类参数不存在例子</h2> <p><strong>fixture 定义</strong></p> <p><strong>Tests\Di\Fixtures\Test10</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test10</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">hello</span><span class="token punctuation">(</span>TestNotFound <span class="token variable">$test</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token single-quoted-string string">'test10'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testParseReflectionException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">expectException</span><span class="token punctuation">(</span>\<span class="token package">InvalidArgumentException</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">expectExceptionMessage</span><span class="token punctuation">(</span>
        <span class="token single-quoted-string string">'Class or interface Tests\\Di\\Fixtures\\TestNotFound is register in container is not object.'</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Test10</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'hello'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="instance-注册为实例支持传递数组来设置别名"><a href="#instance-注册为实例支持传递数组来设置别名" class="header-anchor">#</a> instance 注册为实例支持传递数组来设置别名</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testInstanceWithArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$instance</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">stdClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">instance</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'foo'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$instance</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token variable">$instance</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token variable">$instance</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="instance-注册为实例未传递第二个参数会注册自身"><a href="#instance-注册为实例未传递第二个参数会注册自身" class="header-anchor">#</a> instance 注册为实例未传递第二个参数会注册自身</h2> <p>比如说系统中中间件注册。</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token shell-comment comment"># Leevel\Session\Provider\Register::middleware</span>
<span class="token comment">/**
 * 注册 middleware 服务.
 */</span>
<span class="token keyword">protected</span> <span class="token keyword">function</span> <span class="token function">middleware</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void<span class="token punctuation">;</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testInstanceItSelf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">instance</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">instance</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Leevel\\Foo\\Middleware\\Bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Leevel\\Foo\\Middleware\\Bar'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Leevel\\Foo\\Middleware\\Bar'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="参数为类实例例子"><a href="#参数为类实例例子" class="header-anchor">#</a> 参数为类实例例子</h2> <p><strong>fixture 定义</strong></p> <p><strong>Tests\Di\Fixtures\Test20</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test20</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span>Test21 <span class="token variable">$arg1</span><span class="token punctuation">,</span> Test22 <span class="token variable">$arg2</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'test21'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$arg1</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">prop</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'test22'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$arg2</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">prop</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Tests\Di\Fixtures\Test21</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test21</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$prop</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token operator">?</span>string <span class="token variable">$prop</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">prop</span> <span class="token operator">=</span> <span class="token variable">$prop</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Tests\Di\Fixtures\Test22</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test22</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$prop</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token operator">?</span>string <span class="token variable">$prop</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">prop</span> <span class="token operator">=</span> <span class="token variable">$prop</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testCallWithClassArgsAndItInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test20</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$args</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Test21</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Test22</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'world'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token variable">$obj</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'handle'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'test21'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'hello'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'test22'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'world'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="参数为类实例例子和其它参数混合"><a href="#参数为类实例例子和其它参数混合" class="header-anchor">#</a> 参数为类实例例子和其它参数混合</h2> <p><strong>fixture 定义</strong></p> <p><strong>Tests\Di\Fixtures\Test23</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test23</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span>Test24 <span class="token variable">$arg1</span><span class="token punctuation">,</span> Test25 <span class="token variable">$arg2</span><span class="token punctuation">,</span> string <span class="token variable">$arg3</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token single-quoted-string string">'test24'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$arg1</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">prop</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'test25'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$arg2</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">prop</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'three'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token variable">$arg3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Tests\Di\Fixtures\Test24</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test24</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$prop</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token operator">?</span>string <span class="token variable">$prop</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">prop</span> <span class="token operator">=</span> <span class="token variable">$prop</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Tests\Di\Fixtures\Test25</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test25</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token variable">$prop</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token operator">?</span>string <span class="token variable">$prop</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">prop</span> <span class="token operator">=</span> <span class="token variable">$prop</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testCallWithClassArgsAndItInstanceAndMore</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test23</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$args</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Test24</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Test25</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'world'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'more'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token variable">$obj</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'handle'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$args</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'test24'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'hello'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'test25'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'world'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'three'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'more'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="make-创建容器服务并返回支持类名生成服务"><a href="#make-创建容器服务并返回支持类名生成服务" class="header-anchor">#</a> make 创建容器服务并返回支持类名生成服务</h2> <p><strong>fixture 定义</strong></p> <p><strong>Tests\Di\Fixtures\Test28</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Test28</span>
<span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token variable">$test</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span>Test27 <span class="token variable">$test</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">test</span> <span class="token operator">=</span> <span class="token variable">$test</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">test</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testClassArgsASingleClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$test</span> <span class="token operator">=</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span>Test28<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'world'</span><span class="token punctuation">,</span> <span class="token variable">$test</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="魔术方法-get-支持"><a href="#魔术方法-get-支持" class="header-anchor">#</a> 魔术方法 __get 支持</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testMagicGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">foo</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="魔术方法-set-支持"><a href="#魔术方法-set-支持" class="header-anchor">#</a> 魔术方法 __set 支持</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testMagicSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">foo</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">foo</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="clear-清理容器"><a href="#clear-清理容器" class="header-anchor">#</a> clear 清理容器</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testClear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">instance</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'notfound'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'notfound'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'foo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="ioc-容器禁止克隆"><a href="#ioc-容器禁止克隆" class="header-anchor">#</a> IOC 容器禁止克隆</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testClone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">expectException</span><span class="token punctuation">(</span>\<span class="token package">RuntimeException</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">expectExceptionMessage</span><span class="token punctuation">(</span>
        <span class="token single-quoted-string string">'IOC container disallowed clone.'</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container2</span> <span class="token operator">=</span> <span class="token keyword">clone</span> <span class="token variable">$container</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="makeprovider-创建服务提供者"><a href="#makeprovider-创建服务提供者" class="header-anchor">#</a> makeProvider 创建服务提供者</h2> <p><strong>fixture 定义</strong></p> <p><strong>Tests\Di\Fixtures\ProviderTest1</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Leevel<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>IContainer</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Leevel<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Provider</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ProviderTest1</span> <span class="token keyword">extends</span> <span class="token class-name">Provider</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span>IContainer <span class="token variable">$container</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'testMakeProvider'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testMakeProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">makeProvider</span><span class="token punctuation">(</span>ProviderTest1<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'testMakeProvider'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'testMakeProvider'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="callproviderbootstrap-执行服务提供者-bootstrap"><a href="#callproviderbootstrap-执行服务提供者-bootstrap" class="header-anchor">#</a> callProviderBootstrap 执行服务提供者 bootstrap</h2> <p><strong>fixture 定义</strong></p> <p><strong>Tests\Di\Fixtures\ProviderTest2</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Leevel<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>IContainer</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Leevel<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Provider</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ProviderTest2</span> <span class="token keyword">extends</span> <span class="token class-name">Provider</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span>IContainer <span class="token variable">$container</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'testCallProviderBootstrap'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testCallProviderBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">callProviderBootstrap</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ProviderTest1</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'testMakeProvider'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'testMakeProvider'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">callProviderBootstrap</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ProviderTest2</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'testCallProviderBootstrap'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'testCallProviderBootstrap'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="registerproviders-注册服务提供者"><a href="#registerproviders-注册服务提供者" class="header-anchor">#</a> registerProviders 注册服务提供者</h2> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testRegisterProviders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertFalse</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">isBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">registerProviders</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertTrue</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">isBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// do nothing</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">registerProviders</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="registerproviders-注册服务提供者支持延迟写入"><a href="#registerproviders-注册服务提供者支持延迟写入" class="header-anchor">#</a> registerProviders 注册服务提供者支持延迟写入</h2> <p><strong>fixture 定义</strong></p> <p><strong>Tests\Di\Fixtures\DeferredProvider</strong></p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">namespace</span> <span class="token package">Tests<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Fixtures</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Leevel<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>IContainer</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Leevel<span class="token punctuation">\</span>Di<span class="token punctuation">\</span>Provider</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">DeferredProvider</span> <span class="token keyword">extends</span> <span class="token class-name">Provider</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span>IContainer <span class="token variable">$container</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'testDeferredProvider'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">testDeferredProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> void
<span class="token punctuation">{</span>
    <span class="token variable">$deferredProviders</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'test_deferred'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'Tests\\Di\\Fixtures\\DeferredProvider'</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token variable">$deferredAlias</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token single-quoted-string string">'Tests\\Di\\Fixtures\\DeferredProvider'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>
            <span class="token single-quoted-string string">'test_deferred'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'bar'</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token variable">$container</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Container</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertFalse</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">isBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">registerProviders</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$deferredProviders</span><span class="token punctuation">,</span> <span class="token variable">$deferredAlias</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertTrue</span><span class="token punctuation">(</span><span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">isBootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'test_deferred'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'bar'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'test_deferred'</span><span class="token punctuation">,</span> <span class="token variable">$container</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'test_deferred'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">assertSame</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'testDeferredProvider'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">unset</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token single-quoted-string string">'testDeferredProvider'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/docs/architecture/" class="prev router-link-active">
        Summary
      </a></span> <span class="next"><a href="/docs/architecture/provider.html">
        服务提供者
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.1fa40908.js" defer></script><script src="/assets/js/3.7fead861.js" defer></script><script src="/assets/js/17.8b77d7e7.js" defer></script>
  </body>
</html>
